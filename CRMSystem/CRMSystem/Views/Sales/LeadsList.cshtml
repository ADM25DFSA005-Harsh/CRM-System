@model List<SalesAutomation.Models.Lead>
 
@{
    ViewData["Title"] = "Leads";
    var assignedReps = ViewBag.AssignedReps as List<SelectListItem>;
    var selectedRegion = ViewBag.SelectedRegion as string;
    var selectedStatus = ViewBag.SelectedStatus as string;
    var selectedRep = ViewBag.SelectedRep as string;
}
 
@if (TempData["Success"] != null)
{
<div class="alert alert-success alert-dismissible fade show" role="alert">
        @TempData["Success"]
<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
}
 
<div class="container mt-4">
<div class="d-flex justify-content-between align-items-center mb-3">
<h2>Leads</h2>
<a class="btn btn-primary" asp-action="Create" asp-controller="Sales" title="AddLead">Create</a>
</div>
 
    <form method="get" class="row g-3 mb-4">
<div class="col-md-3">
<label class="form-label">Region</label>
<select name="region" class="form-select">
<option value="">All</option>
<option value="North">North</option>
<option value="South">South</option>
<option value="East">East</option>
<option value="West">West</option>
</select>
</div>
 
        <div class="col-md-3">
<label class="form-label">Status</label>
<select name="status" class="form-select">
<option value="">All</option>
<option value="New">New</option>
<option value="Contacted">Contacted</option>
<option value="Qualified">Qualified</option>
<option value="Disqualified">Disqualified</option>
</select>
</div>
 
        <div class="col-md-3">
<label class="form-label">Assigned Rep</label>
<select name="assignedRep" class="form-select">
<option value="">All</option>
                @foreach (var rep in assignedReps)
                {
<option value="@rep.Value" selected="@(rep.Value == selectedRep ? "selected" : null)">@rep.Text</option>
                }
</select>
</div>
<div class="col-md-3 d-flex align-items-end">
<button type="submit" class="btn btn-success w-100">Filter</button>
</div>
</form>
 
    @if (Model != null && Model.Any())
    {
<table class="table table-bordered table-striped">
<thead class="table-dark">
<tr>
<th>Name</th>
<th>Email</th>
<th>Mobile</th>
<th>Region</th>
<th>Status</th>
<th>Assigned To</th>
<th>Created</th>
<th>Actions</th>
</tr>
</thead>
<tbody>
                @foreach (var lead in Model)
                {
<tr>
<td>@($"{lead.Salutation} {lead.FirstName} {lead.LastName}")</td>
<td>@lead.Email</td>
<td>@lead.MobileNumber</td>
<td>@lead.Region</td>
<td>@lead.Status</td>
<td>@lead.AssignedTo</td>
<td>@lead.CreatedDate.ToShortDateString()</td>
<td>
<a class="btn btn-sm btn-outline-primary" asp-action="Details" asp-controller="Sales" asp-route-id="@lead.LeadID">View</a>
</td>
</tr>
                }
</tbody>
</table>
    }
    else
    {
<div class="alert alert-warning text-center">
<a>No leads found. Try adjusting your filters or create a new lead</a>.
</div>
    }
</div>